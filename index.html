<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>腦中風資料分析專案簡報</title>
  <style>
    :root{
      --bg:#f8fafc;
      --card:#fff;
      --accent:#0ea5e9; /* 淺藍色，取代了青綠色 */
      --muted:#64748b;
      --text:#1e293b;
      --border:#e2e8f0;
      --shadow:rgba(100, 116, 139, 0.1); /* 淺色陰影 */
    }
    html,body{height:100%;margin:0;font-family: -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
    body{background:var(--bg); color:var(--text);}
    .wrap{max-width:1100px;margin:30px auto;padding:20px;}
    .slide{
      background:var(--card);
      border-radius:12px;
      padding:36px;
      box-shadow: 0 10px 30px var(--shadow);
      min-height:520px;
      position:relative;
      border: 1px solid var(--border);
    }
    h1,h2,h3{margin:6px 0;color:var(--text);font-weight:600;}
    h1{font-size:2.5rem; color:#0f172a;}
    h2{font-size:2rem; color:var(--accent);}
    p{color:var(--muted);line-height:1.7;}
    ul, ol{color:var(--muted); margin-left:1.1rem; line-height:1.7;}
    .meta{font-size:0.9rem;color:var(--muted)}
    .kbd{display:inline-block;background:#e2e8f0;padding:6px 10px;border-radius:6px;color:var(--accent);font-weight:600}
    .controls{display:flex;gap:10px;position:fixed;left:50%;transform:translateX(-50%);bottom:20px}
    .btn{
      background:var(--card);
      color:var(--accent);
      padding:10px 18px;
      border-radius:8px;
      border:1px solid var(--border);
      cursor:pointer;
      font-weight:600;
      transition: all 0.2s ease-in-out;
    }
    .btn:hover{
      background:var(--accent);
      color:#fff;
      box-shadow: 0 4px 12px rgba(14,165,233,0.2);
    }
    .small{font-size:0.9rem;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-top:20px}
    .card{background:var(--bg);padding:24px;border-radius:10px;border:1px solid var(--border);}
    footer{position:absolute;right:24px;bottom:20px;color:var(--muted);font-size:12px}
    pre {background:#f1f5f9;color:#0f172a; padding:18px;border-radius:8px;overflow:auto; line-height:1.6; border:1px solid var(--border);}
    /* slide visibility */
    .slide { display:none; }
    .slide.active { display:block; animation: fadeIn .35s ease;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none}}
    /* responsive */
    @media(max-width:900px){
      .grid{grid-template-columns:1fr; }
      .wrap{padding:12px;margin:12px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <section class="slide active" id="s-0">
      <h1>腦中風資料分析專案</h1>
      <p class="meta">專案說明 / 面試簡報 — 資料管線、建模、BI 與 AI</p>
      <hr style="border:none;border-top:1px solid var(--border);margin:20px 0 24px;">
      <p>本專案以 Kaggle 腦中風資料集為核心，模擬真實流程。我們從資料庫整合開始，運用 dbt 建立自動化清洗與轉換流程，接著建立資料倉儲。最終成果不僅包含 Power BI 儀表板，還有一套完整的機器學習模型，能有效預測中風風險並進行結果驗證。</p>
      <div class="grid" style="margin-top:28px">
        <div class="card">
          <h3>核心目標</h3>
          <ul>
            <li>建構強韌的資料管線 (ETL / dbt)</li>
            <li>設計星型資料模型，支援 BI 報表分析</li>
            <li>訓練並解釋多種機器學習模型 (Logistic / RF / XGBoost)</li>
            <li>利用台灣衛福部資料進行外部驗證</li>
          </ul>
        </div>
        <div class="card">
          <h3>簡報大綱</h3>
          <ol class="small">
            <li>資料管線 & dbt 流程</li>
            <li>資料建模 (星型模型)</li>
            <li>Power BI 視覺化範例</li>
            <li>AI/ML 建模與評估</li>
            <li>外部驗證與專案總結</li>
          </ol>
        </div>
      </div>
      <footer>作者：Stella LIU ｜ 日期：2025-09-17</footer>
    </section>

    <section class="slide" id="s-1">
      <h2>1. 資料管線 (Data Pipeline)</h2>
      <p>從原始資料到最終應用的完整路徑：Raw → Staging → Integration → Mart → DWH → BI/ML</p>
      <div class="grid">
        <div class="card">
          <h3>資料來源</h3>
          <ul>
            <li>Kaggle: Stroke Prediction Dataset</li>
            <li>台灣衛福部 (MOHW)：作為外部驗證資料</li>
            <li>資料庫：MySQL (模擬臨床資料庫 <code>strokedata</code>)</li>
          </ul>
        </div>
        <div class="card">
          <h3>dbt 轉換流程</h3>
          <ul>
            <li><strong>stg_strokedata</strong>：資料清洗層，處理 "N/A"、標準化欄位型別。</li>
            <li><strong>int_stroke_features</strong>：整合層，建立如 age_group, bmi_category 等衍生欄位。</li>
            <li><strong>mart_stroke_analysis</strong>：彙總層，為 BI 報表預先計算 Age×BMI、Gender×Smoking 等分析指標。</li>
          </ul>
        </div>
      </div>
      <div style="margin-top:20px" class="card">
        <h3>資料倉儲架構</h3>
        <p>所有處理後的資料表都集中存放於資料倉儲 (Data Warehouse)，以便 Power BI 和機器學習模型直接取用，確保資料的一致性和可信度。</p>
      </div>
      <footer>技術：MySQL / dbt / Python / Power BI</footer>
    </section>

    <section class="slide" id="s-2">
      <h2>2. 資料建模 (Data Modeling)</h2>
      <div class="grid">
        <div class="card">
          <h3>星型模型 (Star Schema)</h3>
          <p>我們採用星型模型來組織資料，讓分析更直覺、高效：</p>
          <ul>
            <li><strong>事實表 (Fact Table)</strong>：<code>fact_stroke_cases</code>，記錄每一個病患的觀測資料。</li>
            <li><strong>維度表 (Dimension Tables)</strong>：<code>dim_patient</code>、<code>dim_health</code>、<code>dim_lifestyle</code>，提供不同角度的描述性資訊。</li>
          </ul>
        </div>
        <div class="card">
          <h3>維度表欄位範例</h3>
          <ul>
            <li><strong>dim_patient</strong>：patient_key, gender, age, age_group</li>
            <li><strong>dim_health</strong>：health_key, hypertension, heart_disease, bmi, bmi_category</li>
            <li><strong>dim_lifestyle</strong>：lifestyle_key, ever_married, work_type, residence_type, smoking_status</li>
          </ul>
        </div>
      </div>
      <div style="margin-top:20px" class="card">
        <h3>設計優勢</h3>
        <p>這種設計能讓你在 BI 工具中輕鬆地進行多維度切片 (slice & dice) 分析，同時保持資料的一致性，並將複雜的查詢轉換為簡單的 Join 操作，大幅提升報表效能。</p>
      </div>
      <footer>輸出：事實表 + 維度表 → BI/ML 應用</footer>
    </section>

    <section class="slide" id="s-3">
      <h2>3. Mart 層與彙總表</h2>
      <div class="card">
        <p>Mart 層是預先彙總的資料集，專為特定分析場景設計，例如 <code>mart_age_x_bmi</code> 和 <code>mart_gender_x_smoking</code>。它的主要好處是：</p>
        <ul>
          <li><strong>提升報表速度</strong>：Power BI 可直接讀取彙總表，省去即時計算的負擔。</li>
          <li><strong>簡化分析流程</strong>：直接提供業務或臨床人員所需的資料，無須自行處理複雜的 SQL 查詢。</li>
          <li><strong>支援多種應用</strong>：彙總表不僅能用於 BI，也能作為機器學習的特徵工程來源。</li>
        </ul>
      </div>
      <div class="grid" style="margin-top:20px">
        <div class="card">
          <h3>範例：mart_age_x_bmi</h3>
          <p>欄位：age_group, bmi_category, total_count, stroke_count, stroke_rate</p>
        </div>
        <div class="card">
          <h3>範例：mart_gender_x_smoking</h3>
          <p>欄位：gender, smoking_status, total_count, stroke_count, stroke_rate</p>
        </div>
      </div>
      <footer>好處：快速、簡潔、可供 BI 直接讀取</footer>
    </section>

    <section class="slide" id="s-4">
      <h2>4. Power BI 可視化範例</h2>
      <div class="grid">
        <div class="card">
          <h3>關鍵績效指標 (KPI)</h3>
          <ul>
            <li>總樣本數、中風總數、中風率、平均年齡、平均 BMI。</li>
            <li>透過直觀的 KPI 卡片，快速掌握核心數據。</li>
          </ul>
        </div>
        <div class="card">
          <h3>核心視覺化圖表</h3>
          <ul>
            <li><strong>熱力圖</strong>：年齡組 × BMI 的中風率分布。</li>
            <li><strong>分組柱狀圖</strong>：比較不同性別與吸菸狀態的中風比例。</li>
            <li><strong>條形圖</strong>：分析不同職業類型與中風的關聯性。</li>
          </ul>
        </div>
      </div>
      <div style="margin-top:20px" class="card">
        <h3>互動式分析</h3>
        <p>儀表板上設計了多種篩選器 (slicers)，讓使用者可以根據性別、年齡組、吸菸狀態等條件，即時切換和過濾所有圖表，進行深度探索性分析。</p>
      </div>
    </section>

    <section class="slide" id="s-5">
      <h2>5. AI / 機器學習流程</h2>
      <p>我們的建模過程嚴謹且完整，確保模型的可靠性：</p>
      <ol>
        <li><strong>資料探索</strong>：詳細檢查數據分布、缺失值和異常值。</li>
        <li><strong>特徵工程</strong>：處理缺失值、類別編碼、數值標準化。</li>
        <li><strong>模型訓練</strong>：採用多種模型（邏輯迴歸、隨機森林、XGBoost）進行比對。</li>
        <li><strong>模型評估</strong>：使用 Accuracy, Precision, Recall, F1, ROC-AUC 等指標全面評估。</li>
        <li><strong>模型選擇</strong>：綜合考量指標與業務需求，最終選定解釋性最強的邏輯迴歸。</li>
        <li><strong>模型解釋</strong>：分析各特徵的重要性，例如 SHAP values。</li>
        <li><strong>外部驗證</strong>：利用台灣衛福部的公開數據，驗證模型在不同資料集上的穩定性。</li>
      </ol>
      <div style="margin-top:20px" class="card">
        <h3>邏輯迴歸的解釋性</h3>
        <p>邏輯迴歸模型的每個係數 (β) 都可以被解釋為特徵對中風機率的影響倍數 (Odds Ratio)，這對於臨床應用特別有價值。</p>
      </div>
    </section>

    <section class="slide" id="s-6">
      <h2>6. 模型訓練與結果</h2>
      <div class="grid">
        <div class="card">
          <h3>模型表現</h3>
          <ul>
            <li><strong>邏輯迴歸 (Logistic Regression)</strong>：表現最佳，ROC-AUC 約 0.83，特別擅長找出高風險個案。</li>
            <li><strong>隨機森林 (Random Forest) & XGBoost</strong>：雖然整體準確率高，但對於中風（少數類別）的預測敏感度較差。</li>
          </ul>
        </div>
        <div class="card">
          <h3>指標觀察</h3>
          <ul>
            <li><strong>邏輯迴歸</strong>：Recall 值高，能有效篩出大多數中風個案，但 Precision 略低（會有一些誤報）。</li>
            <li><strong>RF/XGB</strong>：Accuracy 值高，但對少數類 (中風) 的 Recall 值較低。</li>
          </ul>
        </div>
      </div>
      <div style="margin-top:20px" class="card">
        <h3>特徵重要性分析</h3>
        <p>分析顯示，幾個關鍵因子對中風風險影響最顯著：<br><strong>平均血糖 (avg_glucose_level)、BMI、年齡 (age)、吸菸狀態 (smoking_status)、高血壓 (hypertension) 與心臟病 (heart_disease)。</strong></p>
      </div>
    </section>

    <section class="slide" id="s-7">
      <h2>7. 外部驗證 (MOHW 台灣資料)</h2>
      <p>我們將模型應用於台灣衛福部的腦血管疾病相關數據，進行外部驗證：</p>
      <ul>
        <li><strong>比對群體分布</strong>：檢查模型預測的風險分布是否與台灣實際統計資料相符。</li>
        <li><strong>評估模型穩定性</strong>：計算模型在台灣資料集上的 ROC-AUC 和校準度 (calibration)。</li>
        <li><strong>策略調整</strong>：若驗證結果不佳，可評估是否需要對模型進行領域適應 (domain adaptation) 或重新訓練。</li>
      </ul>
      <div class="card" style="margin-top:20px">
        <h3>驗證步驟</h3>
        <ol>
          <li><strong>資料對齊</strong>：將 MOHW 資料的欄位、分組與模型輸入格式對齊。</li>
          <li><strong>模型推論</strong>：將 MOHW 資料輸入模型，計算每個個體的預測中風機率。</li>
          <li><strong>效果評估</strong>：利用 ROC 曲線、校準曲線等工具來評估模型的實際表現。</li>
        </ol>
      </div>
    </section>

    <section class="slide" id="s-8">
      <h2>8. 線上風險計算器 (Demo 構想)</h2>
      <p>這是一個基於邏輯迴歸模型的應用構想：</p>
      <pre>
z = β0 + β1*age + β2*bmi + β3*hypertension + ...
P = 1 / (1 + exp(-z))
      </pre>
      <p>可以將此模型部署為一個輕量級的網頁應用程式 (例如使用 Flask 或純前端 JS)，讓使用者即時計算中風風險：</p>
      <ul>
        <li><strong>使用者輸入</strong>：年齡、BMI、高血壓、心臟病、吸菸狀態、性別。</li>
        <li><strong>系統輸出</strong>：即時顯示中風機率 (百分比)、風險等級（低/中/高）與相關建議。</li>
      </ul>
    </section>

    <section class="slide" id="s-9">
      <h2>9. 結論與未來展望</h2>
      <ul>
        <li><strong>專案成果</strong>：我們成功建置了從資料管線、倉儲到 BI 報表與 AI 模型的完整流程。</li>
        <li><strong>核心發現</strong>：星型模型有效地支援了多維度分析，而邏輯迴歸模型因其優異的解釋性，最適合本次的應用情境。</li>
        <li><strong>未來工作</strong>：下一步將強化外部驗證流程，並嘗試將模型部署為線上工具，同時探索更進階的時間序列分析，以期能預測中風趨勢。</li>
      </ul>
      <div style="margin-top:20px" class="card">
        <h3>Q&A</h3>
        <p>感謝您的時間！</p>
      </div>
    </section>
  </div>

  <div class="controls">
    <button class="btn" id="prev">◀ 上一頁</button>
    <div style="min-width:20px"></div>
    <button class="btn" id="next">下一頁 ▶</button>
  </div>

  <script>
    // simple slide controller
    const slides = Array.from(document.querySelectorAll('.slide'));
    let idx = 0;
    function show(i){
      slides.forEach(s=>s.classList.remove('active'));
      slides[i].classList.add('active');
      idx = i;
      window.scrollTo(0,0);
    }
    document.getElementById('prev').addEventListener('click', ()=>{
      show((idx - 1 + slides.length) % slides.length);
    });
    document.getElementById('next').addEventListener('click', ()=>{
      show((idx + 1) % slides.length);
    });
    document.addEventListener('keydown', e=>{
      if(e.key === 'ArrowRight') show((idx + 1) % slides.length);
      if(e.key === 'ArrowLeft') show((idx - 1 + slides.length) % slides.length);
      if(e.key === 'Home') show(0);
      if(e.key === 'End') show(slides.length -1);
    });
    // initial
    show(0);
  </script>
</body>
</html>
